# OWASP ZAP Configuration for Cart Quote WooCommerce & Email Plugin
# ==================================================================
# Configuration file for automated security scanning with OWASP ZAP

# Context Configuration
# ---------------------
context.name=CartQuotePlugin
context.description=Cart Quote WooCommerce & Email Plugin Security Scan
context.include=.*cart-quote.*
context.include=.*admin-ajax\.php.*cart_quote.*
context.exclude=.*\.css
context.exclude=.*\.js
context.exclude=.*\.png
context.exclude=.*\.jpg
context.exclude=.*\.gif

# Target URLs
# ------------
target.url=http://localhost
target.ajax=/wp-admin/admin-ajax.php

# Authentication Configuration
# ----------------------------
authentication.type=form
authentication.method=POST
authentication.loginUrl=http://localhost/wp-login.php
authentication.loginPageUrl=http://localhost/wp-login.php
authentication.usernameParam=log
authentication.passwordParam=pwd
authentication.loggedInIndicator=\Qwp-admin-bar-my-account\E
authentication.loggedOutIndicator=\Qwp-login.php\E

# Credentials (use environment variables or prompt)
# credentials.username=admin
# credentials.password=password

# User Configuration
# ------------------
users.name=admin
users.username=admin
users.enabled=true

# Scan Policy
# -----------
scan.policy.name=CartQuote-Security-Policy
scan.policy.strength=HIGH
scan.policy.threshold=LOW

# Active Scan Rules to Enable
# ---------------------------
# 40012 - Cross Site Scripting (Reflected)
# 40014 - SQL Injection
# 40016 - Cross Site Request Forgery
# 40018 - Path Traversal
# 40019 - Remote File Inclusion
# 40020 - Source Code Disclosure
# 40021 - Server Side Include
# 40023 - XML External Entity Attack
# 40024 - CRLF Injection
# 40025 - JSONP Callback
# 40026 - Cross Site Scripting (Persistent)
# 90019 - Server Side Template Injection

ascan.enabled=40012,40014,40016,40018,40019,40020,40021,40023,40024,40025,40026,90019
ascan.disabled=10058

# Passive Scan Rules
# ------------------
pscan.enabled=all

# Spider Configuration
# --------------------
spider.maxDepth=5
spider.threadCount=2
spider.maxDuration=30
spider.parseForms=true
spider.parseComments=true
spider.parseRobotsTxt=true

# AJAX Spider Configuration
# -------------------------
ajaxspider.enabled=true
ajaxspider.maxDuration=10
ajaxspider.maxCrawlDepth=3

# Scan Endpoints
# --------------
# Define specific AJAX endpoints to test
endpoints.1=/wp-admin/admin-ajax.php?action=cart_quote_submit&nonce=TEST
endpoints.2=/wp-admin/admin-ajax.php?action=cart_quote_update_cart&nonce=TEST&cart_item_key=TEST&quantity=1
endpoints.3=/wp-admin/admin-ajax.php?action=cart_quote_remove_item&nonce=TEST&cart_item_key=TEST
endpoints.4=/wp-admin/admin-ajax.php?action=cart_quote_get_cart&nonce=TEST
endpoints.5=/wp-admin/admin-ajax.php?action=cart_quote_admin_update_status&nonce=TEST&id=1&status=pending
endpoints.6=/wp-admin/admin-ajax.php?action=cart_quote_admin_create_event&nonce=TEST&id=1
endpoints.7=/wp-admin/admin-ajax.php?action=cart_quote_admin_resend_email&nonce=TEST&id=1&email_type=both
endpoints.8=/wp-admin/admin-ajax.php?action=cart_quote_admin_save_notes&nonce=TEST&id=1&notes=TEST
endpoints.9=/wp-admin/admin-ajax.php?action=cart_quote_admin_export_csv&nonce=TEST
endpoints.10=/wp-admin/admin-ajax.php?action=cart_quote_google_oauth_callback&state=TEST

# Admin Pages
# -----------
admin.pages.1=/wp-admin/admin.php?page=cart-quote-manager
admin.pages.2=/wp-admin/admin.php?page=cart-quote-settings
admin.pages.3=/wp-admin/admin.php?page=cart-quote-google

# Alert Thresholds
# ----------------
alert.threshold.XSS=MEDIUM
alert.threshold.SQLI=LOW
alert.threshold.CSRF=LOW
alert.threshold.PathTraversal=MEDIUM

# Report Configuration
# --------------------
report.format=HTML,JSON,XML
report.output=./zap-reports/
report.filename=cart-quote-security-report

# Proxy Configuration
# -------------------
proxy.host=localhost
proxy.port=8080

# Notes
# -----
# 1. Run ZAP in daemon mode or with GUI
# 2. Configure WordPress to trust ZAP's SSL certificate
# 3. Test against a fresh development installation
# 4. Review all HIGH and CRITICAL alerts
# 5. False positives may occur - manual verification required
